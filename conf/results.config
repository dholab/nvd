params {
    // NVD RESULTS
    // ********************************************************************************
    nvd_results = params.results + "/nvd"

    // pre-processing subworkflow
    preprocess_results = params.nvd_results + "/01_preprocessing"
    human_virus_reads = params.preprocess_results + "/01_human_virus_reads"
    spades_contigs = params.preprocess_results + "/02_spades_contigs"
    masked_filtered_contigs = params.preprocess_results + "/03_masked_filtered_contigs"

    // human virus contig extraction subworkflow
    human_virus_extraction = params.nvd_results + "/02_human_viruses"
    stat_classification_passes = params.human_virus_extraction + "/01_stat_passes"
    stat_report = params.human_virus_extraction + "/02_full_stat_report"
    human_viruses = params.human_virus_extraction + "/03_human_virus_results"

    // megablast classificaton subworkflow
    megablast = params.nvd_results + "/03_megablast_classification"
    all_megablast = params.megablast + "/01_annotated_megablast_classifications"
    virus_megablast = params.megablast + "/02_megablast_viruses"

    // blastn classificaton subworkflow
    blastn = params.nvd_results + "/04_blastn_classification"
    annotated_blastn = params.blastn + "/01_annotated_blastn_classifications"
    virus_blastn = params.blastn + "/02_blastn_viruses"
    blast_merged = params.blastn + "/03_blastn_megablast_merged"

    // labkey bundling subworkflow
    labkey_bundling = params.nvd_results + "/05_labkey_bundling"
    // ********************************************************************************

    // GOTTCHA2 RESULTS
    // ********************************************************************************
    gottcha2_results = params.results + "/gottcha2"
    gottcha2_profiles = params.gottcha2_results + "/01_gottcha2_profiles"
    extracted_reads = params.gottcha2_results + "/02_extracted_reads"
    labkey_bundling = params.gottcha2_results + "/03_labkey_bundling"
    // ********************************************************************************

    // CLUMPIFY RESULTS
    // ********************************************************************************
    clumpify_results = params.results + "/clumpify"
    // ********************************************************************************
}

// Assign the above paths to publish directories in processes throughout the pipeline
process {
    withName: 'EXTRACT_HUMAN_VIRUS_READS' {
        publishDir = [
            path: { params.human_virus_reads },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'RUN_SPADES' {
        publishDir = [
            path: { params.spades_contigs },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]

    }

    withName: 'FILTER_SHORT_CONTIGS' {
        publishDir = [
            path: { params.masked_filtered_contigs },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'CLASSIFY_CONTIGS_FIRST_PASS' {
        publishDir = [
            path: { params.stat_classification_passes },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'GENERATE_CONTIGS_TAXA_LIST' {
        publishDir = [
            path: { params.stat_classification_passes },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'GENERATE_STAT_CONTIG_REPORT' {
        publishDir = [
            path: { params.stat_report },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'IDENTIFY_HUMAN_VIRUS_FAMILY_CONTIGS' {
        publishDir = [
            path: { params.human_viruses },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'EXTRACT_HUMAN_VIRUS_CONTIGS' {
        publishDir = [
            path: { params.human_viruses },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'ANNOTATE_MEGABLAST_RESULTS' {
        publishDir = [
            path: { params.all_megablast },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'FILTER_NON_VIRUS_MEGABLAST_NODES' {
        publishDir = [
            path: { params.virus_megablast },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'REMOVE_MEGABLAST_MAPPED_CONTIGS' {
        publishDir = [
            path: { params.virus_megablast },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'ANNOTATE_BLASTN_RESULTS' {
        publishDir = [
            path: { params.annotated_blastn },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'FILTER_NON_VIRUS_BLASTN_NODES' {
        publishDir = [
            path: { params.virus_blastn },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'MERGE_FILTERED_BLAST_RESULTS' {
        publishDir = [
            path: { params.blast_merged },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'CLUMP_READS' {
        publishDir = [
            path: { params.clumpify_results },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'LABKEY_UPLOAD_BLAST' {
        publishDir = [
            path: { params.labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'LABKEY_UPLOAD_FASTA' {
        publishDir = [
            path: { params.labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

}

