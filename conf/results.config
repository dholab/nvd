params {
    // NVD RESULTS
    // ********************************************************************************
    nvd_results = results + "/nvd"

    // pre-processing subworkflow
    preprocess_results = nvd_results + "/01_preprocessing"
    human_virus_reads = preprocess_results + "/01_human_virus_reads"
    spades_contigs = preprocess_results + "/02_spades_contigs"
    masked_filtered_contigs = preprocess_results + "/03_masked_filtered_contigs"

    // human virus contig extraction subworkflow
    human_virus_extraction = nvd_results + "/02_human_viruses"
    stat_classification_passes = human_virus_extraction + "/01_stat_passes"
    stat_report = human_virus_extraction + "/02_full_stat_report"
    human_viruses = human_virus_extraction + "/03_human_virus_results"
    human_virus_maps = human_viruses + "/mapped_reads"

    // megablast classificaton subworkflow
    megablast = nvd_results + "/03_megablast_classification"
    all_megablast = megablast + "/01_annotated_megablast_classifications"
    virus_megablast = megablast + "/02_megablast_viruses"

    // blastn classificaton subworkflow
    blastn = nvd_results + "/04_blastn_classification"
    annotated_blastn = blastn + "/01_annotated_blastn_classifications"
    virus_blastn = blastn + "/02_blastn_viruses"
    blast_merged = blastn + "/03_blastn_megablast_merged"

    // labkey bundling subworkflow
    labkey_bundling = nvd_results + "/05_labkey_bundling"
    // ********************************************************************************

    // GOTTCHA2 RESULTS
    // ********************************************************************************
    gottcha2_results = results + "/gottcha2"
    gottcha2_profiles = gottcha2_results + "/01_gottcha2_profiles"
    extracted_reads = gottcha2_results + "/02_extracted_reads"
    gottcha2_labkey_bundling = gottcha2_results + "/03_labkey_bundling"
    // ********************************************************************************

    // CLUMPIFY RESULTS
    // ********************************************************************************
    clumpify_results = results + "/clumpify"
    // ********************************************************************************
}

// Assign the above paths to publish directories in processes throughout the pipeline
process {
    withName: 'EXTRACT_HUMAN_VIRUS_READS' {
        publishDir = [
            path: { params.human_virus_reads },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'RUN_SPADES' {
        publishDir = [
            path: { params.spades_contigs },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]

    }

    withName: 'FILTER_SHORT_CONTIGS' {
        publishDir = [
            path: { params.masked_filtered_contigs },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'CLASSIFY_CONTIGS_FIRST_PASS' {
        publishDir = [
            path: { params.stat_classification_passes },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'GENERATE_CONTIGS_TAXA_LIST' {
        publishDir = [
            path: { params.stat_classification_passes },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'GENERATE_STAT_CONTIG_REPORT' {
        publishDir = [
            path: { params.stat_report },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'IDENTIFY_HUMAN_VIRUS_FAMILY_CONTIGS' {
        publishDir = [
            path: { params.human_viruses },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'EXTRACT_HUMAN_VIRUS_CONTIGS' {
        publishDir = [
            path: { params.human_viruses },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    // withName: 'MAP_READS_TO_CONTIGS' {
    //     publishDir = [
    //         path: { params.human_virus_maps },
    //         mode: 'copy',
    //         saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
    //         enabled: true
    //     ]
    // }

    withName: 'COUNT_MAPPED_READS' {
        publishDir = [
            path: { params.human_virus_maps },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'ANNOTATE_MEGABLAST_RESULTS' {
        publishDir = [
            path: { params.all_megablast },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'FILTER_NON_VIRUS_MEGABLAST_NODES' {
        publishDir = [
            path: { params.virus_megablast },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'REMOVE_MEGABLAST_MAPPED_CONTIGS' {
        publishDir = [
            path: { params.virus_megablast },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'ANNOTATE_BLASTN_RESULTS' {
        publishDir = [
            path: { params.annotated_blastn },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'FILTER_NON_VIRUS_BLASTN_NODES' {
        publishDir = [
            path: { params.virus_blastn },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'MERGE_FILTERED_BLAST_RESULTS' {
        publishDir = [
            path: { params.blast_merged },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'CLUMP_READS' {
        publishDir = [
            path: { params.clumpify_results },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'SCRUB_HUMAN_READS' {
        publishDir = [
            path: { params.clumpify_results },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'VALIDATE_LK_EXP_TO_CLUSTER' {
        publishDir = [
            path: { params.labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'LABKEY_UPLOAD_BLAST' {
        publishDir = [
            path: { params.labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'LABKEY_UPLOAD_FASTA' {
        publishDir = [
            path: { params.labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'LABKEY_UPLOAD_GOTTCHA2_FASTA' {
        publishDir = [
            path: { params.gottcha2_labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

    withName: 'LABKEY_UPLOAD_GOTTCHA2_FULL' {
        publishDir = [
            path: { params.gottcha2_labkey_bundling },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename },
            enabled: true
        ]
    }

}

